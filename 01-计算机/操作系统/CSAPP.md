# 第零章 为什么学CSAPP

1. 对计算机有一个完整的体系结构
2. 将计算机中的概念串成一条线
3. 从逻辑门到操作系统到各种APP我们是怎么做的

<img src="C:\Users\20711\Desktop\计算机体系结构.png" alt="计算机体系结构" style="zoom:50%;" />

> 上图为计算机的体系架构，下层为上层的实现，下层为上层的抽象。在ISA层，硬件和软件相遇了

冯诺依曼结构

1. 定义：任何要计算机完成的工作都要被编写成程序，然后将程序和原始数据送入主存并启动执行。一旦程序被启动，计算机应能在不需操作人员的干预下，自动完成逐条取出指令和执行指令的任务
2. 组成：
   - 主存：存放指令和数据，形式上没有区别(都是二进制字符串)，计算机能够区分指令和数据的区别
   - 控制器：能自动取出指令运行
   - 运算器：能进行加减乘除基本运算和逻辑运算
   - 输入设备：操作人员和计算机通讯的工具
   - 输出设备：操作人员和计算机通讯的工具
3. 工作次序：
   1. 根据 PC取地址
   2. 指令译码(该做什么)
   3. 取操作数
   4. 指令执行
   5. 回写结果
   6. 修改PC的值

# 第一章 计算机系统漫游

计算机操作系统是由硬件和系统软件组成的，它们共同工作来运行应用程序

操作系统的两个基本功能：

1. 防止硬件被失控的程序滥用
2. 向应用程序提供简单而又一致的机制来控制复杂而又大不相同的硬件设备



计算机中最小单位是位，一字节为8位

文本文件：只由ASCII码字符构成的文件

二进制文件：除了文本文件的其他文件

上下文：系统中的所有数据，都是由一串比特组成的。区分不同数据对象的唯一方法是我们读取到这些数据时的上下文。

> 比如：数据类型，同一个字节可以被不同类型读取成不同的数据



总线：贯穿整个系统的一组电子管道。携带信息字节并负责在各个部件间传递

字：总线能传送的字节块。系统基本参数。目前大多数位64位

I/O设备：输入输出设备。每一个I/O通过一个控制器或适配器与I/O总线相连

主存：一个临时存储设备，在处理器执行程序时，用来存放程序和程序处理的数据

处理器：中央处理单元，简称处理器。是解释（或执行）存储在主存中指令的引擎

程序计数器（PC）：处理器中一个大小为一个字的寄存器。任何时刻，程序计数器都指向主存中某条机器语言指令（即含有该条指令的地址）

寄存器文件：寄存器的一种。可以存放变量，函数的局部变量

算术/逻辑单元：负责计算新的数据和地址值

指令集架构：处理器执行指令的一系列模型



**高速缓存**：根据机械原理，较大的存储设备要比较小的存储设备运行得慢，快速设备的造价远高于同类的低速设备。

因此，寄存器和主存之间进行通信会有比较大的时间损耗，为了减小这种损耗，高速缓存应运而生。

目前主流处理器分为L1，L2，L3。程序访问L1的速度和直接访问寄存器差不多。程序访问L2比访问L1慢5倍，同时比主存块5~10倍



进程：对操作系统中正在运行的程序的一种抽象

并发运行：一个进程的指令和另一个进程的指令是交错运行的

上下文切换：操作系统实现多个进程交错运行的机制

线程：一个进程可以由多个称为线程的执行单元组成

虚拟内存：为每一个进程提供了一种假象，即每个进程都在独占地使用主存。每个进程看到的内存都是一致的

文件：文件就是字节序列。每个I/O设备都可以看成一个文件



Amdahl定律：要想显著加速整个系统，必须提升全系统相当大的部分的速度

并发：一个执行单元交替执行多个任务

并行：多个执行单元同时执行多个任务

同时超线程（又称超线程技术）：允许一个cpu执行多个控制流

指令集并行：同时执行多条指令

超标量处理器：处理器可以达到的一种执行速率，即比一个时钟周期一条指令更快



# 第二章 程序结构和执行

![计算机系统中的数据类型](C:\Users\20711\Desktop\计算机系统中的数据类型.png)

亿点概念：

- 机器数：用0/1编码的计算机内部的0/1序列。机器数没有特定的解释不知道表达的意义
- 真值：真正的值
- 将数值类型的真值转换为机器数的三点
  1. 进位计数制(二进制，八进制，十进制，十六进制)
  2. 定、浮点表示(定点整数，定点小数，浮点数)
  3. 二进制编码(原码，补码，移码，反码)

> 浮点数可以使用一个定点小数和一个定点整数来表示

- 2的幂

  1. 2^0 =1
  2. 2^1 =2
  3. 2^2 =4
  4. 2^-1 = 0.5
  5. 2^-2 = 0.125

- 计算机常见单位

  - 位(bit,b)是计算机中处理、存储、传输信息的最小单位
  - 1字节(Byte,B) = 8bit
  - 容量单位
    - 千字节(KB)	1KB = 1024B
    - 兆字节(MB)   1MB = 1024KB
    - 千兆字节(GB) 1GB = 1024MB
    - 兆兆字节(TB)   1TB = 1024GB
  - 通信中的带宽单位
    - 千比特/秒(kb/s)	1kbps = 1000bps
    - 兆比特/秒(Mb/s)   1Mbps = 1000kbps
    - 千兆比特/秒(Gb/s) 1Gbps = 1000Mbps
    - 兆兆比特/秒(Tb/s)   1Tbps = 1000Gbps

- 现代计算机中，存储器按字节编址。

  - 字节是最小可寻址单位
  - 如果以字节为一个排列单位，则LSB表示最低有效字节，MSB表示最高有效字节

- 字和字长

  - 字长指数据通路的宽度。等于CPU内部总线的宽度、运算器的位数、通用寄存器的宽度。最大内存大小也与字长有关

  - 字表示被处理信息的单位，用来度量数据类型的宽度。可以和字长一样， 也可以不一样

    

## 2.1 不同进制之间的转换

- R进制数转十进制：按权展开
- 十进制转二进制
  - 整数：“除基取余，上右下左”
  - 小数：乘积取整，上左下右

> 简便方式，整数部分取最接近的2的幂数，一点点拼

## 2.2 整数编码

## 2.3 浮点数编码

## 2.4 非数值编码

- 逻辑值：0代表假，1代表真。可以用一位二进制数，也可用一串01序列
- 字符

<img src="C:\Users\20711\Pictures\Screenshots\ASCII码.png" alt="ASCII码" style="zoom:50%;" />

> 横坐标为第一个16进制数，纵坐标为第二个16进制数。如NULL对应00，A对应41，！对应21

## 2.5 数据的存储和排列顺序

- 变量的地址是最小地址。例：int a的地址为0x100。则它占用了0x100~0x103
- 多字节数据的存放顺序：假设int a=12345678。地址为0x100~0x103
  - 大端法：12 34 56 78
  - 小端法：78 56 34 12
  - 不同系统之间进行通讯需要考虑字节顺序问题



